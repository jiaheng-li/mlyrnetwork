top = "Layer 1                                                                              Layer 2                                                                                   Layer 3   ",
left = "  LSM Basis                  SBM Basis             ERGM Basis       ")
## Arrange all 9 graphs in one plot
commonplot <- ggarrange(fig[[7]],fig[[8]],fig[[9]],fig[[1]],fig[[2]],fig[[3]],fig[[4]],fig[[5]],fig[[6]],ncol = 3, nrow = 3)
annotate_figure(commonplot,
top = "Layer 1                                                                              Layer 2                                                                                   Layer 3   ",
left = "  LSM Basis                  SBM Basis             ERGM Basis       ")
annotate_figure(commonplot,
top = "Layer 1                                                                              Layer 2                                                                                   Layer 3      ",
left = "  LSM Basis                  SBM Basis             ERGM Basis       ")
annotate_figure(commonplot,
top = "Layer 1                                                                              Layer 2                                                                            Layer 3      ",
left = "  LSM Basis                  SBM Basis             ERGM Basis       ")
annotate_figure(commonplot,
top = "Layer 1                                                                              Layer 2                                                                         Layer 3      ",
left = "  LSM Basis                  SBM Basis             ERGM Basis       ")
annotate_figure(commonplot,
top = "Layer 1                                                                              Layer 2                                                                         Layer 3      ",
left = "  LSM Basis                  SBM Basis             ERGM Basis       ",
size = 10)
annotate_figure(commonplot,
top = "Layer 1                                                                              Layer 2                                                                         Layer 3      ",
left = "  LSM Basis                  SBM Basis             ERGM Basis       ",
fig.lab.size = 10)
annotate_figure(commonplot,
top = "Layer 1                                                                              Layer 2                                                                         Layer 3      ",
left = "  LSM Basis                  SBM Basis             ERGM Basis       ",
fig.lab.size = 30)
## Arrange all 9 graphs in one plot
commonplot <- ggarrange(fig[[7]],fig[[8]],fig[[9]],fig[[1]],fig[[2]],fig[[3]],fig[[4]],fig[[5]],fig[[6]],ncol = 3, nrow = 3)
annotate_figure(commonplot,
top = "Layer 1                                                                              Layer 2                                                                         Layer 3      ",
left = "  LSM Basis                  SBM Basis             ERGM Basis       ",
fig.lab.size = 30)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 10),
left = "  LSM Basis                  SBM Basis             ERGM Basis       ",
fig.lab.size = 30)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 30),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 30)
)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 30),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 20)
)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 20),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 20)
)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 10),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 20)
)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 10),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 10)
)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 10),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 10,rot = 90)
)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 15),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 15,rot = 90)
)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 12),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 12,rot = 90)
)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 14),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 14,rot = 90)
)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 13),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 13,rot = 90)
)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 12),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 12,rot = 90)
)
## Arrange all 9 graphs in one plot
commonplot <- ggarrange(fig[[7]],fig[[8]],fig[[9]],fig[[1]],fig[[2]],fig[[3]],fig[[4]],fig[[5]],fig[[6]],ncol = 3, nrow = 3)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 12),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 12,rot = 90)
)
rm(list = ls())
suppressMessages(library(latentnet))
suppressMessages(library(ergm))
library(GGally)
library(latentnet)
library(ggplot2)
library(ggpubr)
require(grid)
library(reshape2)
adv <- read.table("C:/Users/ljhhe/OneDrive - Florida State University/Research/Applications/Lazega/LazegaLawyers/ELadv.dat")
friend <- read.table("C:/Users/ljhhe/OneDrive - Florida State University/Research/Applications/Lazega/LazegaLawyers/ELfriend.dat")
work <- read.table("C:/Users/ljhhe/OneDrive - Florida State University/Research/Applications/Lazega/LazegaLawyers/ELwork.dat")
N <- length(adv[,1])
mlnetwork <- matrix(0,1,3)
worksym <- matrix(0,N,N)
advsym <- matrix(0,N,N)
friendsym <- matrix(0,N,N)
### Create symmetric adjacent matrix
## work = 1
## advice = 2
## friend = 3
for(i in c(1:(N-1))){
for(j in c((i + 1):N)){
if(work[i,j] == 1 && work[j,i] == 1){
mlnetwork <- rbind(mlnetwork,c(i,j,1))
worksym[i,j] = 1
worksym[j,i] = 1
}
if(adv[i,j] == 1 && adv[j,i] == 1){
mlnetwork <- rbind(mlnetwork,c(i,j,2))
advsym[i,j] = 1
advsym[j,i] = 1
}
if(friend[i,j] == 1 && friend[j,i] == 1){
mlnetwork <- rbind(mlnetwork,c(i,j,3))
friendsym[i,j] = 1
friendsym[j,i] = 1
}
}
}
mlnetwork <- mlnetwork[-1,]
samp_num <- 1
burnin <- 100
k <- 3  #number of layers
mdim <- 6
mterm <- rep("ml_order2",mdim)
intv <- 3
seed <- 123456
rNR_tol <- 1000
rNR_max <- 1000
rMCMLE_max <- 1000
g <- 0
mlnetwork
rm(list = ls())
library(ergm)
library(GGally)
library(latentnet)
library(ggplot2)
library(ggpubr)
require(grid)
library(reshape2)
library(sna)
## Create figure handles for each of the network
fig <- vector("list",length = 3*3)
node_colors <- c("orange","blue","purple")
# Generate SBM with K = 3 blocks
N <- 75
node_membs <- c(rep(1, 25), rep(2, 25), rep(3, 25))
p_within <- .25
p_between <- .01
gen_sbm <- function(N, node_membs, p_within, p_between) {
net <- matrix(0, nrow = N, ncol = N)
for (i in 1:(N-1)) {
for (j in (i+1):N) {
net[i, j] <- rbinom(1, 1, ifelse(node_membs[i] == node_membs[j], p_within, p_between))
net[j, i] <- net[i, j]
}
}
net <- as.network(net, directed = FALSE)
return(net)
}
## Generate 3 layers of SBM
for(i in c(1:3)){
net <- gen_sbm(N, node_membs, p_within, p_between)
## x is the position of each node, use this for all networks
if(i == 1){
x = gplot.layout.fruchtermanreingold(net, NULL)
}
## Draw the SBM network, use "mode" argument to control the node position
net %v% "x" = x[, 1]
net %v% "y" = x[, 2]
fig[[i]] <- ggnet2(net, node.size = 3, node.color = node_colors[i], mode = c("x", "y") ) +
#labs(title = paste0("Layer ", as.character(i))) +  ## Change the graph title here
theme(plot.title = element_text(hjust = 0.5,size = 30))   ## Change the font size here
}
## Arrange all 3 networks in one plot
#ggarrange(fig[[1]],fig[[2]],fig[[3]],ncol = 3, nrow = 1)
# Generate Latent Space Model (d = 2)
N <- 75
theta <- -1
pos <- t(sapply(1:N, function(x) { rnorm(2) }))
gen_lsm <- function(N, theta, pos) {
net <- matrix(0, nrow = N, ncol = N)
for (i in 1:(N-1)) {
for (j in (i+1):N) {
odds <- theta - norm(pos[i,] - pos[j, ], type = "2")
p <- exp(odds) / (1 + exp(odds))
net[i, j] <- rbinom(1, 1, p)
net[j, i] <- net[i, j]
}
}
net <- as.network(net, directed = FALSE)
return(net)
}
## Generate 3 layers of LSM
for(i in c(1:3)){
net <- gen_lsm(N, theta, pos)
## x is the position of each node, use this for all networks
if(i == 1){
x = gplot.layout.fruchtermanreingold(net, NULL)
}
## Draw the SBM network, use "mode" argument to control the node position
net %v% "x" = x[, 1]
net %v% "y" = x[, 2]
fig[[i+3]] <- ggnet2(net, node.size = 3, node.color = node_colors[i], mode = c("x", "y") ) +
#labs(title = paste0("Layer ", as.character(i))) +  ## Change the graph title here
theme(plot.title = element_text(hjust = 0.5,size = 30))   ## Change the font size here
}
## Arrange all 3 networks in one plot
#ggarrange(fig[[4]],fig[[5]],fig[[6]],ncol = 3, nrow = 1)
# Generate ERGM
N <- 75
theta <- c(-3.25, .5, .5)
## Generate 3 layers of ERGM
for(i in c(1:3)){
net <- simulate(network.initialize(N, directed = FALSE) ~ edges + gwesp,
coef = theta,
control = control.simulate(MCMC.burnin = 3e+6))
## x is the position of each node, use this for all networks
if(i == 1){
x = gplot.layout.fruchtermanreingold(net, NULL)
}
## Draw the SBM network, use "mode" argument to control the node position
net %v% "x" = x[, 1]
net %v% "y" = x[, 2]
fig[[i+6]] <- ggnet2(net, node.size = 3, node.color = node_colors[i], mode = c("x", "y") ) +
#labs(title = paste0("Layer ", as.character(i))) +  ## Change the graph title here
theme(plot.title = element_text(hjust = 0.5,size = 30))   ## Change the font size here
}
## Arrange all 3 networks in one plot
ggarrange(fig[[7]],fig[[8]],fig[[9]],ncol = 3, nrow = 1)
## Arrange all 9 graphs in one plot
commonplot <- ggarrange(fig[[7]],fig[[8]],fig[[9]],fig[[1]],fig[[2]],fig[[3]],fig[[4]],fig[[5]],fig[[6]],ncol = 3, nrow = 3)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 12),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 14,rot = 90)
)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 14),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 14,rot = 90)
)
rm(list = ls())
library(ergm)
library(GGally)
library(latentnet)
library(ggplot2)
library(ggpubr)
require(grid)
library(reshape2)
library(sna)
## Create figure handles for each of the network
fig <- vector("list",length = 3*3)
node_colors <- c("orange","blue","purple")
# Generate SBM with K = 3 blocks
N <- 75
node_membs <- c(rep(1, 25), rep(2, 25), rep(3, 25))
p_within <- .25
p_between <- .01
gen_sbm <- function(N, node_membs, p_within, p_between) {
net <- matrix(0, nrow = N, ncol = N)
for (i in 1:(N-1)) {
for (j in (i+1):N) {
net[i, j] <- rbinom(1, 1, ifelse(node_membs[i] == node_membs[j], p_within, p_between))
net[j, i] <- net[i, j]
}
}
net <- as.network(net, directed = FALSE)
return(net)
}
## Generate 3 layers of SBM
for(i in c(1:3)){
net <- gen_sbm(N, node_membs, p_within, p_between)
## x is the position of each node, use this for all networks
if(i == 1){
x = gplot.layout.fruchtermanreingold(net, NULL)
}
## Draw the SBM network, use "mode" argument to control the node position
net %v% "x" = x[, 1]
net %v% "y" = x[, 2]
fig[[i]] <- ggnet2(net, node.size = 3, node.color = node_colors[i], mode = c("x", "y") ) +
#labs(title = paste0("Layer ", as.character(i))) +  ## Change the graph title here
theme(plot.title = element_text(hjust = 0.5,size = 30))   ## Change the font size here
}
## Arrange all 3 networks in one plot
#ggarrange(fig[[1]],fig[[2]],fig[[3]],ncol = 3, nrow = 1)
# Generate Latent Space Model (d = 2)
N <- 75
theta <- -1
pos <- t(sapply(1:N, function(x) { rnorm(2) }))
gen_lsm <- function(N, theta, pos) {
net <- matrix(0, nrow = N, ncol = N)
for (i in 1:(N-1)) {
for (j in (i+1):N) {
odds <- theta - norm(pos[i,] - pos[j, ], type = "2")
p <- exp(odds) / (1 + exp(odds))
net[i, j] <- rbinom(1, 1, p)
net[j, i] <- net[i, j]
}
}
net <- as.network(net, directed = FALSE)
return(net)
}
## Generate 3 layers of LSM
for(i in c(1:3)){
net <- gen_lsm(N, theta, pos)
## x is the position of each node, use this for all networks
if(i == 1){
x = gplot.layout.fruchtermanreingold(net, NULL)
}
## Draw the SBM network, use "mode" argument to control the node position
net %v% "x" = x[, 1]
net %v% "y" = x[, 2]
fig[[i+3]] <- ggnet2(net, node.size = 3, node.color = node_colors[i], mode = c("x", "y") ) +
#labs(title = paste0("Layer ", as.character(i))) +  ## Change the graph title here
theme(plot.title = element_text(hjust = 0.5,size = 30))   ## Change the font size here
}
## Arrange all 3 networks in one plot
#ggarrange(fig[[4]],fig[[5]],fig[[6]],ncol = 3, nrow = 1)
# Generate ERGM
N <- 75
theta <- c(-3.25, .5, .5)
## Generate 3 layers of ERGM
for(i in c(1:3)){
net <- simulate(network.initialize(N, directed = FALSE) ~ edges + gwesp,
coef = theta,
control = control.simulate(MCMC.burnin = 3e+6))
## x is the position of each node, use this for all networks
if(i == 1){
x = gplot.layout.fruchtermanreingold(net, NULL)
}
## Draw the SBM network, use "mode" argument to control the node position
net %v% "x" = x[, 1]
net %v% "y" = x[, 2]
fig[[i+6]] <- ggnet2(net, node.size = 3, node.color = node_colors[i], mode = c("x", "y") ) +
#labs(title = paste0("Layer ", as.character(i))) +  ## Change the graph title here
theme(plot.title = element_text(hjust = 0.5,size = 30))   ## Change the font size here
}
## Arrange all 3 networks in one plot
ggarrange(fig[[7]],fig[[8]],fig[[9]],ncol = 3, nrow = 1)
## Arrange all 9 graphs in one plot
commonplot <- ggarrange(fig[[7]],fig[[8]],fig[[9]],fig[[1]],fig[[2]],fig[[3]],fig[[4]],fig[[5]],fig[[6]],ncol = 3, nrow = 3)
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                              Layer 2                                                                         Layer 3      ",size = 14),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 14,rot = 90)
)
#
#
# ### Create 3 graphs for 3 different basis structures
# ## Create figure handles for each of the network
# fig <- vector("list",length = 3*1)
# node_colors <- c("orange","blue","purple")
#
# # Generate SBM with K = 3 blocks
# N <- 75
# node_membs <- c(rep(1, 25), rep(2, 25), rep(3, 25))
# p_within <- .25
# p_between <- .01
#
# gen_sbm <- function(N, node_membs, p_within, p_between) {
#   net <- matrix(0, nrow = N, ncol = N)
#   for (i in 1:(N-1)) {
#     for (j in (i+1):N) {
#       net[i, j] <- rbinom(1, 1, ifelse(node_membs[i] == node_membs[j], p_within, p_between))
#       net[j, i] <- net[i, j]
#     }
#   }
#   net <- as.network(net, directed = FALSE)
#   return(net)
# }
#
#
#
# ## Generate SBM
# for(i in c(1:1)){
#   net <- gen_sbm(N, node_membs, p_within, p_between)
#
#   ## x is the position of each node, use this for all networks
#   if(i == 1){
#     x = gplot.layout.fruchtermanreingold(net, NULL)
#
#   }
#
#   ## Draw the SBM network, use "mode" argument to control the node position
#   net %v% "x" = x[, 1]
#   net %v% "y" = x[, 2]
#   fig[[2]] <- ggnet2(net, node.size = 3, node.color = node_colors[2], mode = c("x", "y") ) +
#     labs(title = paste0("SBM Basis")) +  ## Change the graph title here
#     theme(plot.title = element_text(hjust = 0.5,size = 20))   ## Change the font size here
# }
#
#
# ## Generate LSM
# N <- 75
# theta <- -1
# pos <- t(sapply(1:N, function(x) { rnorm(2) }))
#
# gen_lsm <- function(N, theta, pos) {
#   net <- matrix(0, nrow = N, ncol = N)
#   for (i in 1:(N-1)) {
#     for (j in (i+1):N) {
#       odds <- theta - norm(pos[i,] - pos[j, ], type = "2")
#       p <- exp(odds) / (1 + exp(odds))
#       net[i, j] <- rbinom(1, 1, p)
#       net[j, i] <- net[i, j]
#     }
#   }
#   net <- as.network(net, directed = FALSE)
#   return(net)
# }
#
# for(i in c(1:1)){
#   net <- gen_lsm(N, theta, pos)
#
#   ## x is the position of each node, use this for all networks
#   if(i == 1){
#     x = gplot.layout.fruchtermanreingold(net, NULL)
#
#   }
#
#   ## Draw the SBM network, use "mode" argument to control the node position
#   net %v% "x" = x[, 1]
#   net %v% "y" = x[, 2]
#   fig[[3]] <- ggnet2(net, node.size = 3, node.color = node_colors[3], mode = c("x", "y") ) +
#     labs(title = paste0("LSM Basis")) +  ## Change the graph title here
#     theme(plot.title = element_text(hjust = 0.5,size = 20))   ## Change the font size here
# }
#
#
#
# # Generate ERGM
# N <- 75
# theta <- c(-3.25, .5, .5)
#
# ## Generate the ERGM
# for(i in c(1:1)){
#   net <- simulate(network.initialize(N, directed = FALSE) ~ edges + gwesp,
#                   coef = theta,
#                   control = control.simulate(MCMC.burnin = 3e+6))
#
#   ## x is the position of each node, use this for all networks
#   if(i == 1){
#     x = gplot.layout.fruchtermanreingold(net, NULL)
#
#   }
#
#   ## Draw the SBM network, use "mode" argument to control the node position
#   net %v% "x" = x[, 1]
#   net %v% "y" = x[, 2]
#   fig[[1]] <- ggnet2(net, node.size = 3, node.color = node_colors[1], mode = c("x", "y") ) +
#     labs(title = paste0("ERGM Basis")) +  ## Change the graph title here
#     theme(plot.title = element_text(hjust = 0.5,size = 20))   ## Change the font size here
# }
#
# ## Arrange all 3 networks in one plot
# ggarrange(fig[[1]],fig[[2]],fig[[3]],ncol = 3, nrow = 1)
#
#
annotate_figure(commonplot,
top = text_grob("Layer 1                                                                        Layer 2                                                                  Layer 3      ",size = 14),
left = text_grob("  LSM Basis                  SBM Basis             ERGM Basis       ",size = 14,rot = 90)
)
library("devtools")
devtools::document()
set.seed(123456)
seed <- sample(1:9999999,1,replace = FALSE)
rm(list = ls())
library("devtools")
devtools::document()
getwd()
rm(list = ls())
setwd("C:/Users/ljhhe/OneDrive - Florida State University/GitHub/mlyrnetwork")
library("devtools")
devtools::document()
set.seed(123456)
seed <- sample(1:9999999,1,replace = FALSE)
## Parameter settings
burnin <- 100
k <- 4  # number of layers, okay to change
H <- 2  # highest order of interactions, okay to change (<= k)
mdim <- 0
for(i in 1:H){
mdim <- mdim + choose(k,i)
}
intv <- 3 # sampling iterval
iter_max <- 30000 # maximum iterations for estimation
# generate stochastic block model basis as an example
# can be set to 'Ber', 'LSM' and 'other'
mterm <- 'SBM'
# set SBM parameters
B <- 3
p_within <- .25
p_between <- .01
# set basis network arguments for SBM basis
basis_arguments <- c(B, p_within ,p_between, seed)
# generate theta for layers
params <- matrix(runif(mdim,-1,1),1,mdim)
params[,c(3,6)] = 0
theta <- params[1,]
N <- 100 # number of nodes
## Sample a k-layer multilayer network
mlnet <- samp_ml(theta,N = N, k = k, H = H ,mdim = mdim, seed = seed, mterm = 'SBM', basis_arguments = basis_arguments)
draw_mlnet(mlnet,N)
## plot the k-layer multilayer network sampled above
draw_mlnet(mlnet$net,N)
